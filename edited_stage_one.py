# -*- coding: utf-8 -*-
"""Edited_Stage one.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Ob7P53bqd6k8VcdOO_Ure16wDVjy1-yQ
"""

def translate_dna_to_protein(dna_sequence, stop_at_stop=False):
    """
    Translates a DNA sequence into a protein sequence.

    Args:
        dna_sequence (str): DNA sequence (e.g., "ATGC...").
        stop_at_stop (bool): If True, translation stops at the first stop codon.

    Returns:
        str: Translated protein sequence.
    """
    codon_table = {
        'ATA':'I', 'ATC':'I', 'ATT':'I', 'ATG':'M',
        'ACA':'T', 'ACC':'T', 'ACG':'T', 'ACT':'T',
        'AAC':'N', 'AAT':'N', 'AAA':'K', 'AAG':'K',
        'AGC':'S', 'AGT':'S', 'AGA':'R', 'AGG':'R',
        'CTA':'L', 'CTC':'L', 'CTG':'L', 'CTT':'L',
        'CCA':'P', 'CCC':'P', 'CCG':'P', 'CCT':'P',
        'CAC':'H', 'CAT':'H', 'CAA':'Q', 'CAG':'Q',
        'CGA':'R', 'CGC':'R', 'CGG':'R', 'CGT':'R',
        'GTA':'V', 'GTC':'V', 'GTG':'V', 'GTT':'V',
        'GCA':'A', 'GCC':'A', 'GCG':'A', 'GCT':'A',
        'GAC':'D', 'GAT':'D', 'GAA':'E', 'GAG':'E',
        'GGA':'G', 'GGC':'G', 'GGG':'G', 'GGT':'G',
        'TCA':'S', 'TCC':'S', 'TCG':'S', 'TCT':'S',
        'TTC':'F', 'TTT':'F', 'TTA':'L', 'TTG':'L',
        'TAC':'Y', 'TAT':'Y', 'TAA':'*', 'TAG':'*',
        'TGC':'C', 'TGT':'C', 'TGA':'*', 'TGG':'W'
    }

# Clean sequence and validate input
    dna_sequence = dna_sequence.strip().upper()
    if not dna_sequence:
        raise ValueError("DNA sequence is empty.")
    if any(base not in "ATGC" for base in dna_sequence):
        raise ValueError("Invalid DNA sequence. Only A, T, G, and C are allowed.")

    # Warn if sequence length not divisible by 3
    if len(dna_sequence) % 3 != 0:
        print("⚠️  Warning: DNA sequence length is not a multiple of 3. Truncating the remainder.")

    # Translate
    protein = []
    for i in range(0, len(dna_sequence) - len(dna_sequence) % 3, 3):
        codon = dna_sequence[i:i+3]
        amino_acid = codon_table.get(codon, 'X')
        if stop_at_stop and amino_acid == '*':
            break
        protein.append(amino_acid)

    return "".join(protein)


# Example usage:
if __name__ == "__main__":
    dna = "ATGCGTAGATAGaaa"
    protein = translate_dna_to_protein(dna)
    print(f"DNA sequence: {dna}")
    print(f"Protein sequence: {protein}")

def hamming_distance(name1, name2):
    """
    Calculate the Hamming distance between two strings (e.g., Slack and Twitter usernames).
    Pads the shorter string with underscores (_) to make lengths equal.

    Args:
        name1 (str): First string (e.g., Slack username)
        name2 (str): Second string (e.g., Twitter handle)

    Returns:
        int: Hamming distance (number of differing characters)
    """
    # Pad the shorter name
    max_len = max(len(name1), len(name2))
    name1 = name1.ljust(max_len, '_')
    name2 = name2.ljust(max_len, '_')

    # Count differences
    distance = sum(ch1 != ch2 for ch1, ch2 in zip(name1, name2))
    return distance

# Example usage
slack_username = "josoga"
twitter_handle = "joseph"

print(f"Hamming distance between '{slack_username}' and '{twitter_handle}':",
      hamming_distance(slack_username, twitter_handle))

#Gene Expression (Heatmap & Volcano Plot)
#a. Normalized counts for HBR vs UHR samples - https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_top_deg_normalized_counts.csv
#b. Differential expression results (chromosome 22) - https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_deg_chr22_with_significance.csv
#Breast Cancer Diagnostic Data (Correlation & Scatter/Density Plots) -
#c–f. Breast Cancer Wisconsin dataset -https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/data-3.csv

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt

# -----------------------------
# Load dataset from GitHub
# -----------------------------
url = "https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_top_deg_normalized_counts.csv"

# Load the dataset
df = pd.read_csv(url, index_col=0)  # assuming first column has gene names

# -----------------------------
#Inspect data
# -----------------------------
print("Data shape:", df.shape)
print(df.head())

# Ensure rows = genes, columns = samples

# -----------------------------
# Create clustered heatmap
# -----------------------------
plt.figure(figsize=(10, 8))
sns.clustermap(
    df,
    cmap="viridis",           # color gradient
    figsize=(10, 10),         # size of the plot
    row_cluster=True,         # cluster genes
    col_cluster=True,         # cluster samples
    xticklabels=True,         # label samples
    yticklabels=True          # label genes
)
plt.title("Clustered Heatmap of Gene Expression", pad=100)
plt.show()

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# ------------------------------------
#Load DEG results from GitHub or another URL
# ------------------------------------

url = "https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/hbr_uhr_deg_chr22_with_significance.csv"

# Load dataset
df = pd.read_csv(url)


#Inspect data
# -----------------------------
print("Data shape:", df.shape)
print(df.head())

# ------------------------------------
# Plot Volcano Plot
# ------------------------------------
plt.figure(figsize=(8, 6))
sns.scatterplot(
    data=df,
    x='log2FoldChange',
    y='-log10PAdj',
    hue='significance',
    palette={'up': 'green', 'down': 'orange', 'ns': 'grey'},
    alpha=0.7,
    edgecolor=None
)

# Add dashed lines for thresholds
plt.axvline(x=1, color='black', linestyle='--', linewidth=1)
plt.axvline(x=-1, color='black', linestyle='--', linewidth=1)
plt.axhline(y=-np.log10(0.05), color='red', linestyle='--', linewidth=1)

# Labels and title
plt.xlabel('log2(Fold Change)')
plt.ylabel('-log10(Adjusted p-value)')
plt.title('Volcano Plot of Differentially Expressed Genes')

# Clean up legend
plt.legend(title='Gene Regulation', loc='upper right')

plt.tight_layout()
plt.show()

import pandas as pd
import matplotlib.pyplot as plt

# Load data directly from an online source
url = "https://raw.githubusercontent.com/HackBio-Internship/2025_project_collection/refs/heads/main/Python/Dataset/data-3.csv"
df = pd.read_csv(url)

# Check first few rows to confirm columns
print(df.head())

# Create a scatter plot: texture_mean vs radius_mean
plt.figure(figsize=(8,6))
colors = {'M': 'red', 'B': 'blue'}

# Plot by diagnosis
for diag in df['diagnosis'].unique():
    subset = df[df['diagnosis'] == diag]
    plt.scatter(subset['radius_mean'], subset['texture_mean'],
                color=colors[diag], label=f"{diag} ({'Malignant' if diag=='M' else 'Benign'})",
                alpha=0.6, edgecolors='k')

# Label and style
plt.title('Breast Cancer Data: Texture vs Radius', fontsize=14)
plt.xlabel('Mean Radius', fontsize=12)
plt.ylabel('Mean Texture', fontsize=12)
plt.legend(title='Diagnosis')
plt.grid(True, linestyle='--', alpha=0.5)

# Show plot
plt.show()

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from google.colab import files

# Upload CSV
uploaded = files.upload()
df = pd.read_csv('data-3.csv')

#  Correlation Heatmap
features = ['radius_mean','texture_mean','perimeter_mean','area_mean','smoothness_mean','compactness_mean']
corr_matrix = df[features].corr()

plt.figure(figsize=(8,6))
sns.heatmap(corr_matrix, annot=True, fmt=".2f", cmap='coolwarm', square=True)
plt.title('Correlation Heatmap of Key Features')
plt.show()

# Create scatter plot for smoothness vs compactness
plt.figure(figsize=(8,6))

for diag in df['diagnosis'].unique():
    subset = df[df['diagnosis'] == diag]
    plt.scatter(subset['compactness_mean'], subset['smoothness_mean'],
                color=colors[diag],
                label=f"{diag} ({'Malignant' if diag=='M' else 'Benign'})",
                alpha=0.6,
                edgecolors='k')

# Add labels, title and gridlines
plt.xlabel('Mean Compactness', fontsize=12)
plt.ylabel('Mean Smoothness', fontsize=12)
plt.title('Breast Cancer Data: Compactness vs Smoothness', fontsize=14)
plt.grid(True, linestyle='--', alpha=0.5)
plt.legend(title='Diagnosis')

plt.show()

import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from google.colab import files

# Upload CSV
uploaded = files.upload()
df = pd.read_csv('data-3.csv')

# Map diagnosis
df['diagnosis'] = df['diagnosis'].map({'M':'malignant','B':'benign'})

# Scale x-axis
mal_area = df[df['diagnosis']=='malignant']['area_mean'] / 1000
ben_area = df[df['diagnosis']=='benign']['area_mean'] / 1000

plt.figure(figsize=(8,6))
sns.kdeplot(mal_area, bw_adjust=2, label='Malignant', color='blue', fill=True)
sns.kdeplot(ben_area, bw_adjust=2, label='Benign', color='orange', fill=True)

plt.xticks([0,1,2,3], labels=['0','1000','2000','3000'])
plt.yticks([0,0.00025,0.0005,0.00075])
plt.xlabel('area_mean')
plt.ylabel('Density')
plt.legend()
plt.grid(False)
plt.show()